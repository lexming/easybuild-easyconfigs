# updated: Denis Kristak (INUITS)
easyblock = 'PythonBundle'

name = 'vitessce-python'
version = '20230222'
local_commit = '7bd0a00'

homepage = 'https://github.com/vitessce/vitessce-python'
description = "Python API and Jupyter widget facilitating interactive visualization of spatial single-cell data with Vitessce."

toolchain = {'name': 'foss', 'version': '2022a'}

dependencies = [
    ('Python', '3.10.4'),
    ('zarr', '2.13.3'),
    ('SciPy-bundle', '2022.05'),
    ('aiohttp', '3.8.3'),
    ('dask', '2022.10.0'),
    ('h5py', '3.7.0'),
    ('scikit-image', '0.19.3'),
]

exts_default_options = {
    'source_urls': [PYPI_SOURCE],
    'use_pip': True,
    'sanity_pip_check': True,
}

local_hatchling_preinstallopts = "sed -i 's|packaging>=21.3|packaging>=20.9|g' PKG-INFO && "
local_hatchling_preinstallopts += "sed -i 's|packaging>=21.3|packaging>=20.9|g' src/hatchling/ouroboros.py && "

exts_list = [
    ('natsort', '8.2.0', {
        'checksums': ['57f85b72c688b09e053cdac302dd5b5b53df5f73ae20b4874fcbffd8bf783d11'],
    }),
    ('pathspec', '0.10.1', {
        'checksums': ['7ace6161b621d31e7902eb6b5ae148d12cfd23f4a249b9ffb6b9fee12084323d'],
    }),
    ('fsspec', '2023.1.0'),
    ('hatchling', '1.11.1', {
        'checksums': ['9f84361f70cf3a7ab9543b0c3ecc64211ed2ba8a606a71eb6a473c1c9b08e1d0'],
        'preinstallopts': local_hatchling_preinstallopts,
    }),
    ('negspy', '0.2.24'),
    ('mypy_extensions', '1.0.0', {
        'checksums': ['75dbf8955dc00442a438fc4d0666508a9a97b6bd41aa2f0ffe9d2f2725af0782'],
    }),
    ('hatch-fancy-pypi-readme', '22.8.0', {
        'sources': [{
                'download_filename': 'hatch_fancy_pypi_readme-%(version)s.tar.gz',
                'filename': SOURCE_TAR_GZ,
        }],    
    }),
    ('hatch-vcs', '0.3.0', {
        'sources': [{
                'download_filename': 'hatch_vcs-%(version)s.tar.gz',
                'filename': SOURCE_TAR_GZ,
        }],    
    }),
    ('black', '23.1.0', {
        'preinstallopts': "sed -i 's|packaging>=22.0|packaging>=20.9|g' pyproject.toml && "
    }),
    ('anndata', '0.8.0'),
    ('ome-zarr', '0.2.1'),
    ('tifffile', '2022.10.10', {
    }),
    (name, version, {
        'source_urls': ['https://github.com/vitessce/vitessce-python/archive/'],
        'sources': [{
            'download_filename': '%s.tar.gz' % local_commit,
            'filename': SOURCE_TAR_GZ,
            }],
        'modulename': 'vitessce',
    }),
]

moduleclass = 'bio'
